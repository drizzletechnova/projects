{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"Tbl20GTOed_E"},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import seaborn as sns\n","import matplotlib.pyplot as plt\n","%matplotlib inline\n","from sklearn.compose import ColumnTransformer\n","from sklearn.impute import SimpleImputer\n","from sklearn.model_selection import train_test_split\n","from sklearn.linear_model import LinearRegression,Ridge,Lasso,ElasticNet\n","from sklearn.metrics import r2_score\n","from sklearn.preprocessing import PolynomialFeatures\n","from sklearn.metrics import mean_squared_error\n","from sklearn.preprocessing import OneHotEncoder\n","from sklearn.preprocessing import StandardScaler\n","from sklearn.preprocessing import MinMaxScaler\n","from sklearn.pipeline import Pipeline\n","from sklearn.model_selection import GridSearchCV\n","def format_with_commas(x):\n","    return \"{:,.0f}\".format(x)\n","#pd.options.display.float_format = format_with_commas\n","pd.set_option('display.float_format',format_with_commas)\n","pd.set_option('display.float_format', lambda x: '%.2f' % x)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"56hTWV7BHXih","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1721751250375,"user_tz":-60,"elapsed":8229,"user":{"displayName":"Adehunoluwa Praise","userId":"01213622966247288395"}},"outputId":"20a0f581-ce94-439a-addf-464e77a58a43"},"outputs":[{"output_type":"stream","name":"stdout","text":["File downloaded successfully\n"]}],"source":["import requests\n","\n","url = 'https://data.montgomerycountymd.gov/api/views/v76h-r7br/rows.csv?accessType=DOWNLOAD'\n","response = requests.get(url)\n","\n","if response.status_code == 200:\n","    with open('retail.csv', 'wb') as file:\n","        file.write(response.content)\n","    print('File downloaded successfully')\n","else:\n","    print('Failed to download file')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wW_wrbskEuWT","colab":{"base_uri":"https://localhost:8080/","height":486},"executionInfo":{"status":"ok","timestamp":1721751261826,"user_tz":-60,"elapsed":911,"user":{"displayName":"Adehunoluwa Praise","userId":"01213622966247288395"}},"outputId":"cec134cc-f03a-4ac3-9da3-09c0f7f60664"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   YEAR  MONTH                           SUPPLIER ITEM CODE  \\\n","0  2020      1  REPUBLIC NATIONAL DISTRIBUTING CO    100009   \n","1  2020      1                          PWSWN INC    100024   \n","2  2020      1            RELIABLE CHURCHILL LLLP      1001   \n","3  2020      1          LANTERNA DISTRIBUTORS INC    100145   \n","4  2020      1               DIONYSOS IMPORTS INC    100293   \n","\n","                      ITEM DESCRIPTION ITEM TYPE  RETAIL SALES  \\\n","0                  BOOTLEG RED - 750ML      WINE          0.00   \n","1            MOMENT DE PLAISIR - 750ML      WINE          0.00   \n","2  S SMITH ORGANIC PEAR CIDER - 18.7OZ      BEER          0.00   \n","3        SCHLINK HAUS KABINETT - 750ML      WINE          0.00   \n","4       SANTORINI GAVALA WHITE - 750ML      WINE          0.82   \n","\n","   RETAIL TRANSFERS  WAREHOUSE SALES  \n","0              0.00             2.00  \n","1              1.00             4.00  \n","2              0.00             1.00  \n","3              0.00             1.00  \n","4              0.00             0.00  "],"text/html":["\n","  <div id=\"df-327b773a-6cee-4e39-895c-1312f2b24537\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>YEAR</th>\n","      <th>MONTH</th>\n","      <th>SUPPLIER</th>\n","      <th>ITEM CODE</th>\n","      <th>ITEM DESCRIPTION</th>\n","      <th>ITEM TYPE</th>\n","      <th>RETAIL SALES</th>\n","      <th>RETAIL TRANSFERS</th>\n","      <th>WAREHOUSE SALES</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2020</td>\n","      <td>1</td>\n","      <td>REPUBLIC NATIONAL DISTRIBUTING CO</td>\n","      <td>100009</td>\n","      <td>BOOTLEG RED - 750ML</td>\n","      <td>WINE</td>\n","      <td>0.00</td>\n","      <td>0.00</td>\n","      <td>2.00</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2020</td>\n","      <td>1</td>\n","      <td>PWSWN INC</td>\n","      <td>100024</td>\n","      <td>MOMENT DE PLAISIR - 750ML</td>\n","      <td>WINE</td>\n","      <td>0.00</td>\n","      <td>1.00</td>\n","      <td>4.00</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2020</td>\n","      <td>1</td>\n","      <td>RELIABLE CHURCHILL LLLP</td>\n","      <td>1001</td>\n","      <td>S SMITH ORGANIC PEAR CIDER - 18.7OZ</td>\n","      <td>BEER</td>\n","      <td>0.00</td>\n","      <td>0.00</td>\n","      <td>1.00</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2020</td>\n","      <td>1</td>\n","      <td>LANTERNA DISTRIBUTORS INC</td>\n","      <td>100145</td>\n","      <td>SCHLINK HAUS KABINETT - 750ML</td>\n","      <td>WINE</td>\n","      <td>0.00</td>\n","      <td>0.00</td>\n","      <td>1.00</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2020</td>\n","      <td>1</td>\n","      <td>DIONYSOS IMPORTS INC</td>\n","      <td>100293</td>\n","      <td>SANTORINI GAVALA WHITE - 750ML</td>\n","      <td>WINE</td>\n","      <td>0.82</td>\n","      <td>0.00</td>\n","      <td>0.00</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-327b773a-6cee-4e39-895c-1312f2b24537')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-327b773a-6cee-4e39-895c-1312f2b24537 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-327b773a-6cee-4e39-895c-1312f2b24537');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-dabe9148-473b-4252-ab7e-46d4ca132a02\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-dabe9148-473b-4252-ab7e-46d4ca132a02')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-dabe9148-473b-4252-ab7e-46d4ca132a02 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"data"}},"metadata":{},"execution_count":7}],"source":["\n","data = pd.read_csv(\"retail.csv\")\n","data.head()"]},{"cell_type":"markdown","metadata":{"id":"gnHBO8n8ibdW"},"source":["# Data description"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NuKflN6AwYn-","colab":{"base_uri":"https://localhost:8080/","height":560},"executionInfo":{"status":"ok","timestamp":1721751250390,"user_tz":-60,"elapsed":139,"user":{"displayName":"Adehunoluwa Praise","userId":"01213622966247288395"}},"outputId":"61518a6c-74b3-4448-e529-27a9ac1ee8e1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["            Feature                                       Description  \\\n","0              YEAR                                     Calendar Year   \n","1             MONTH                                             Month   \n","2          SUPPLIER                                     Supplier Name   \n","3         ITEM CODE                                         Item code   \n","4  ITEM DESCRIPTION                                  Item Description   \n","5         ITEM TYPE                                         Item Type   \n","6      RETAIL SALES       Cases of product sold from DLC dispensaries   \n","7  RETAIL TRANSFERS  Cases of product transferred to DLC dispensaries   \n","8   WAREHOUSE SALES             Cases of product sold to MC licensees   \n","\n","  Data Type  \n","0    Number  \n","1    Number  \n","2      Text  \n","3      Text  \n","4      Text  \n","5      Text  \n","6    Number  \n","7    Number  \n","8    Number  "],"text/html":["\n","  <div id=\"df-831ee4b8-9c02-438e-9bce-3410a11e128e\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Feature</th>\n","      <th>Description</th>\n","      <th>Data Type</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>YEAR</td>\n","      <td>Calendar Year</td>\n","      <td>Number</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>MONTH</td>\n","      <td>Month</td>\n","      <td>Number</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>SUPPLIER</td>\n","      <td>Supplier Name</td>\n","      <td>Text</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ITEM CODE</td>\n","      <td>Item code</td>\n","      <td>Text</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ITEM DESCRIPTION</td>\n","      <td>Item Description</td>\n","      <td>Text</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>ITEM TYPE</td>\n","      <td>Item Type</td>\n","      <td>Text</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>RETAIL SALES</td>\n","      <td>Cases of product sold from DLC dispensaries</td>\n","      <td>Number</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>RETAIL TRANSFERS</td>\n","      <td>Cases of product transferred to DLC dispensaries</td>\n","      <td>Number</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>WAREHOUSE SALES</td>\n","      <td>Cases of product sold to MC licensees</td>\n","      <td>Number</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-831ee4b8-9c02-438e-9bce-3410a11e128e')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-831ee4b8-9c02-438e-9bce-3410a11e128e button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-831ee4b8-9c02-438e-9bce-3410a11e128e');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-6f59cac2-89f2-49a2-a94e-ebdfb995c3bf\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-6f59cac2-89f2-49a2-a94e-ebdfb995c3bf')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-6f59cac2-89f2-49a2-a94e-ebdfb995c3bf button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","  <div id=\"id_4f0d0218-8e7d-4a2b-87df-f0a29b78f56e\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_4f0d0218-8e7d-4a2b-87df-f0a29b78f56e button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('df');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df","summary":"{\n  \"name\": \"df\",\n  \"rows\": 9,\n  \"fields\": [\n    {\n      \"column\": \"Feature\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 9,\n        \"samples\": [\n          \"RETAIL TRANSFERS\",\n          \"MONTH\",\n          \"ITEM TYPE\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Description\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 9,\n        \"samples\": [\n          \"Cases of product transferred to DLC dispensaries\",\n          \"Month\",\n          \"Item Type\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Data Type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"Text\",\n          \"Number\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":3}],"source":["\n","features = {\n","    \"Feature\": [\n","        \"YEAR\", \"MONTH\", \"SUPPLIER\", \"ITEM CODE\", \"ITEM DESCRIPTION\",\n","        \"ITEM TYPE\", \"RETAIL SALES\", \"RETAIL TRANSFERS\", \"WAREHOUSE SALES\"\n","    ],\n","    \"Description\": [\n","        \"Calendar Year\", \"Month\", \"Supplier Name\", \"Item code\",\n","        \"Item Description\", \"Item Type\", \"Cases of product sold from DLC dispensaries\",\n","        \"Cases of product transferred to DLC dispensaries\", \"Cases of product sold to MC licensees\"\n","    ],\n","    \"Data Type\": [\n","        \"Number\", \"Number\", \"Text\", \"Text\", \"Text\", \"Text\", \"Number\", \"Number\", \"Number\"\n","    ]\n","}\n","\n","# Create a DataFrame\n","df = pd.DataFrame(features)\n","\n","df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JrmeYjlCzdfR"},"outputs":[],"source":["data.columns = data.columns.str.replace(' ', '_')"]},{"cell_type":"code","execution_count":null,"metadata":{"collapsed":true,"id":"rw4_HxZCsIXX","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1721751273058,"user_tz":-60,"elapsed":38,"user":{"displayName":"Adehunoluwa Praise","userId":"01213622966247288395"}},"outputId":"00af3bec-9234-4ae9-a6e3-1bf2ef6cd5a2"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 307645 entries, 0 to 307644\n","Data columns (total 9 columns):\n"," #   Column            Non-Null Count   Dtype  \n","---  ------            --------------   -----  \n"," 0   YEAR              307645 non-null  int64  \n"," 1   MONTH             307645 non-null  int64  \n"," 2   SUPPLIER          307478 non-null  object \n"," 3   ITEM_CODE         307645 non-null  object \n"," 4   ITEM_DESCRIPTION  307645 non-null  object \n"," 5   ITEM_TYPE         307644 non-null  object \n"," 6   RETAIL_SALES      307642 non-null  float64\n"," 7   RETAIL_TRANSFERS  307645 non-null  float64\n"," 8   WAREHOUSE_SALES   307645 non-null  float64\n","dtypes: float64(3), int64(2), object(4)\n","memory usage: 21.1+ MB\n"]}],"source":["data.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VM0BuHsmpvsj","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1721751269796,"user_tz":-60,"elapsed":39,"user":{"displayName":"Adehunoluwa Praise","userId":"01213622966247288395"}},"outputId":"0ad10a5a-f058-4099-a63e-ec044a14e0af"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(307645, 9)"]},"metadata":{},"execution_count":9}],"source":["data.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"006Dt0UHG3zc","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1721750193508,"user_tz":-60,"elapsed":458,"user":{"displayName":"Adehunoluwa Praise","userId":"01213622966247288395"}},"outputId":"5c943352-64f2-45e6-8096-292d1adea5d3"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["YEAR                  0\n","MONTH                 0\n","SUPPLIER            167\n","ITEM_CODE             0\n","ITEM_DESCRIPTION      0\n","ITEM_TYPE             1\n","RETAIL_SALES          3\n","RETAIL_TRANSFERS      0\n","WAREHOUSE_SALES       0\n","dtype: int64"]},"metadata":{},"execution_count":8}],"source":["data.isnull().sum()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uETTqeAKqrUh"},"outputs":[],"source":["\n","numeric_cols = data.select_dtypes(include=['float64', 'int64'])\n","non_numeric_cols = data.select_dtypes(exclude=['float64', 'int64'])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PxqYyxlEFLHo","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1721750193511,"user_tz":-60,"elapsed":32,"user":{"displayName":"Adehunoluwa Praise","userId":"01213622966247288395"}},"outputId":"83b25041-fbf5-4960-93e8-c629495ce510"},"outputs":[{"output_type":"stream","name":"stdout","text":["number of numeric columns 5\n","number of categorical columns 4\n"]}],"source":["print('number of numeric columns' ,numeric_cols.shape[1])\n","print('number of categorical columns' ,non_numeric_cols.shape[1])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Zp45OegNqzWs","colab":{"base_uri":"https://localhost:8080/","height":320},"executionInfo":{"status":"ok","timestamp":1721750193512,"user_tz":-60,"elapsed":24,"user":{"displayName":"Adehunoluwa Praise","userId":"01213622966247288395"}},"outputId":"0110e8a3-cfce-4aa7-8263-33e7cb0423b1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["           YEAR     MONTH  RETAIL_SALES  RETAIL_TRANSFERS  WAREHOUSE_SALES\n","count 307645.00 307645.00     307642.00         307645.00        307645.00\n","mean    2018.44      6.42          7.02              6.94            25.29\n","std        1.08      3.46         30.99             30.24           249.92\n","min     2017.00      1.00         -6.49            -38.49         -7800.00\n","25%     2017.00      3.00          0.00              0.00             0.00\n","50%     2019.00      7.00          0.32              0.00             1.00\n","75%     2019.00      9.00          3.27              3.00             5.00\n","max     2020.00     12.00       2739.00           1990.83         18317.00"],"text/html":["\n","  <div id=\"df-82d9ea55-6863-420b-ba49-1f325eb3102c\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>YEAR</th>\n","      <th>MONTH</th>\n","      <th>RETAIL_SALES</th>\n","      <th>RETAIL_TRANSFERS</th>\n","      <th>WAREHOUSE_SALES</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>307645.00</td>\n","      <td>307645.00</td>\n","      <td>307642.00</td>\n","      <td>307645.00</td>\n","      <td>307645.00</td>\n","    </tr>\n","    <tr>\n","      <th>mean</th>\n","      <td>2018.44</td>\n","      <td>6.42</td>\n","      <td>7.02</td>\n","      <td>6.94</td>\n","      <td>25.29</td>\n","    </tr>\n","    <tr>\n","      <th>std</th>\n","      <td>1.08</td>\n","      <td>3.46</td>\n","      <td>30.99</td>\n","      <td>30.24</td>\n","      <td>249.92</td>\n","    </tr>\n","    <tr>\n","      <th>min</th>\n","      <td>2017.00</td>\n","      <td>1.00</td>\n","      <td>-6.49</td>\n","      <td>-38.49</td>\n","      <td>-7800.00</td>\n","    </tr>\n","    <tr>\n","      <th>25%</th>\n","      <td>2017.00</td>\n","      <td>3.00</td>\n","      <td>0.00</td>\n","      <td>0.00</td>\n","      <td>0.00</td>\n","    </tr>\n","    <tr>\n","      <th>50%</th>\n","      <td>2019.00</td>\n","      <td>7.00</td>\n","      <td>0.32</td>\n","      <td>0.00</td>\n","      <td>1.00</td>\n","    </tr>\n","    <tr>\n","      <th>75%</th>\n","      <td>2019.00</td>\n","      <td>9.00</td>\n","      <td>3.27</td>\n","      <td>3.00</td>\n","      <td>5.00</td>\n","    </tr>\n","    <tr>\n","      <th>max</th>\n","      <td>2020.00</td>\n","      <td>12.00</td>\n","      <td>2739.00</td>\n","      <td>1990.83</td>\n","      <td>18317.00</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-82d9ea55-6863-420b-ba49-1f325eb3102c')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-82d9ea55-6863-420b-ba49-1f325eb3102c button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-82d9ea55-6863-420b-ba49-1f325eb3102c');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-54df6a15-a3fc-473f-9051-87b4caf842a8\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-54df6a15-a3fc-473f-9051-87b4caf842a8')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-54df6a15-a3fc-473f-9051-87b4caf842a8 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","summary":"{\n  \"name\": \"numeric_cols\",\n  \"rows\": 8,\n  \"fields\": [\n    {\n      \"column\": \"YEAR\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 108159.51228440202,\n        \"min\": 1.0830605350774478,\n        \"max\": 307645.0,\n        \"num_unique_values\": 6,\n        \"samples\": [\n          307645.0,\n          2018.4385249232068,\n          2020.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"MONTH\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 108766.81735993957,\n        \"min\": 1.0,\n        \"max\": 307645.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          6.423861918770011,\n          7.0,\n          307645.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"RETAIL_SALES\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 108631.96934667067,\n        \"min\": -6.49,\n        \"max\": 307642.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          7.024071388171968,\n          0.32,\n          307642.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"RETAIL_TRANSFERS\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 108670.52968148298,\n        \"min\": -38.49,\n        \"max\": 307645.0,\n        \"num_unique_values\": 7,\n        \"samples\": [\n          307645.0,\n          6.936464528921323,\n          3.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"WAREHOUSE_SALES\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 108473.89533086242,\n        \"min\": -7800.0,\n        \"max\": 307645.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          25.294596954281722,\n          1.0,\n          307645.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":11}],"source":["numeric_cols.describe()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QrVnHS31rFVu","colab":{"base_uri":"https://localhost:8080/","height":247},"executionInfo":{"status":"ok","timestamp":1721750194891,"user_tz":-60,"elapsed":1396,"user":{"displayName":"Adehunoluwa Praise","userId":"01213622966247288395"}},"outputId":"50739048-5d21-4faa-9b48-9393486f5049"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                 SUPPLIER ITEM_CODE          ITEM_DESCRIPTION  \\\n","count                              307478    307645                    307645   \n","unique                                396     34056                     34822   \n","top     REPUBLIC NATIONAL DISTRIBUTING CO     70200  BURGANS ALBARINO - 750ML   \n","freq                                20995        24                        44   \n","\n","       ITEM_TYPE  \n","count     307644  \n","unique         8  \n","top         WINE  \n","freq      187640  "],"text/html":["\n","  <div id=\"df-ef6ac2a8-98ca-43b7-8deb-3aaf3a1b9710\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>SUPPLIER</th>\n","      <th>ITEM_CODE</th>\n","      <th>ITEM_DESCRIPTION</th>\n","      <th>ITEM_TYPE</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>307478</td>\n","      <td>307645</td>\n","      <td>307645</td>\n","      <td>307644</td>\n","    </tr>\n","    <tr>\n","      <th>unique</th>\n","      <td>396</td>\n","      <td>34056</td>\n","      <td>34822</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>top</th>\n","      <td>REPUBLIC NATIONAL DISTRIBUTING CO</td>\n","      <td>70200</td>\n","      <td>BURGANS ALBARINO - 750ML</td>\n","      <td>WINE</td>\n","    </tr>\n","    <tr>\n","      <th>freq</th>\n","      <td>20995</td>\n","      <td>24</td>\n","      <td>44</td>\n","      <td>187640</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ef6ac2a8-98ca-43b7-8deb-3aaf3a1b9710')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-ef6ac2a8-98ca-43b7-8deb-3aaf3a1b9710 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-ef6ac2a8-98ca-43b7-8deb-3aaf3a1b9710');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-7834f4b9-c0da-4060-9103-edadf5929c5e\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-7834f4b9-c0da-4060-9103-edadf5929c5e')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-7834f4b9-c0da-4060-9103-edadf5929c5e button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","summary":"{\n  \"name\": \"non_numeric_cols\",\n  \"rows\": 4,\n  \"fields\": [\n    {\n      \"column\": \"SUPPLIER\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          396,\n          \"20995\",\n          \"307478\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ITEM_CODE\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          34056,\n          \"24\",\n          \"307645\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ITEM_DESCRIPTION\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          34822,\n          \"44\",\n          \"307645\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ITEM_TYPE\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          8,\n          \"187640\",\n          \"307644\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":12}],"source":["non_numeric_cols.describe()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OzpRDHnbxGgF","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1721750194892,"user_tz":-60,"elapsed":51,"user":{"displayName":"Adehunoluwa Praise","userId":"01213622966247288395"}},"outputId":"a1089e9e-d9e5-4b60-d97f-854f5e3137b7"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["ITEM_TYPE\n","WINE            187640\n","LIQUOR           64910\n","BEER             42413\n","KEGS             10146\n","NON-ALCOHOL       1908\n","STR_SUPPLIES       405\n","REF                127\n","DUNNAGE             95\n","Name: count, dtype: int64"]},"metadata":{},"execution_count":13}],"source":["data[\"ITEM_TYPE\"].value_counts()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PP5PVU1-1ant"},"outputs":[],"source":["data.drop(columns = [\"ITEM_CODE\"], inplace= True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gp8puewK1FBs"},"outputs":[],"source":["data[\"TOTAL_SALES\"] = data[\"RETAIL_SALES\"] + data[\"WAREHOUSE_SALES\"]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NN_EVsUQ1oIT","colab":{"base_uri":"https://localhost:8080/","height":747},"executionInfo":{"status":"ok","timestamp":1721751283940,"user_tz":-60,"elapsed":49,"user":{"displayName":"Adehunoluwa Praise","userId":"01213622966247288395"}},"outputId":"892b67ea-2179-4bfa-acb5-d3e15b7cfd06"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["        YEAR  MONTH                                 SUPPLIER  \\\n","61513   2017      7               DOGFISH HEAD CRAFT BREWERY   \n","52363   2017      7                    A VINTNERS SELECTIONS   \n","18422   2020      7        PRESTIGE BEVERAGE GROUP OF MD LLC   \n","268958  2019      9                       E & J GALLO WINERY   \n","7237    2020      1  MCNEILL INDEPENDENT SPIRIT CREATORS LLC   \n","76698   2017      9              COASTAL BREWING COMPANY LLC   \n","266550  2019      9            BUCK DISTRIBUTING COMPANY INC   \n","197602  2019      4            BUCK DISTRIBUTING COMPANY INC   \n","11849   2020      1                   MILLER BREWING COMPANY   \n","279759  2019     10                           LUNEAU USA INC   \n","\n","                                ITEM_DESCRIPTION ITEM_TYPE  RETAIL_SALES  \\\n","61513     DOGFISH HEAD MIDAS TOUCH 6/4 NR - 12OZ      BEER         19.35   \n","52363          DR LOOSEN GRAY SLATE RIES - 750ML      WINE          0.00   \n","18422                    ROBERTSON CHARD - 750ML      WINE          0.16   \n","268958              BAREFOOT CEL CHARD - BIB -3L      WINE         13.83   \n","7237                      GREGARIOUS GIN - 750ML    LIQUOR          3.91   \n","76698   FORDHAM SPICED HARVEST ALE 4/6 NR - 12OZ      BEER          6.00   \n","266550                   REGIA 12/32OZ NR - 32OZ      BEER          0.00   \n","197602  STIEGL GRAPEFRUIT RADLER 16.9OZ 4 PK CAN      BEER          2.70   \n","11849                MOLSON ICE 2/12 LNNR - 12OZ      BEER          0.00   \n","279759                       NICOLAS MER - 750ML      WINE          7.80   \n","\n","        RETAIL_TRANSFERS  WAREHOUSE_SALES  TOTAL_SALES  \n","61513              21.00            41.00        60.35  \n","52363               0.00             4.00         4.00  \n","18422               0.00             1.00         1.16  \n","268958             11.00            16.00        29.83  \n","7237                3.00             0.00         3.91  \n","76698               9.00            35.00        41.00  \n","266550              0.00           197.00       197.00  \n","197602              3.00            19.00        21.70  \n","11849               0.00            41.00        41.00  \n","279759              7.00             2.00         9.80  "],"text/html":["\n","  <div id=\"df-4cd8624e-5407-4e17-8819-1b1b7fbeeba8\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>YEAR</th>\n","      <th>MONTH</th>\n","      <th>SUPPLIER</th>\n","      <th>ITEM_DESCRIPTION</th>\n","      <th>ITEM_TYPE</th>\n","      <th>RETAIL_SALES</th>\n","      <th>RETAIL_TRANSFERS</th>\n","      <th>WAREHOUSE_SALES</th>\n","      <th>TOTAL_SALES</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>61513</th>\n","      <td>2017</td>\n","      <td>7</td>\n","      <td>DOGFISH HEAD CRAFT BREWERY</td>\n","      <td>DOGFISH HEAD MIDAS TOUCH 6/4 NR - 12OZ</td>\n","      <td>BEER</td>\n","      <td>19.35</td>\n","      <td>21.00</td>\n","      <td>41.00</td>\n","      <td>60.35</td>\n","    </tr>\n","    <tr>\n","      <th>52363</th>\n","      <td>2017</td>\n","      <td>7</td>\n","      <td>A VINTNERS SELECTIONS</td>\n","      <td>DR LOOSEN GRAY SLATE RIES - 750ML</td>\n","      <td>WINE</td>\n","      <td>0.00</td>\n","      <td>0.00</td>\n","      <td>4.00</td>\n","      <td>4.00</td>\n","    </tr>\n","    <tr>\n","      <th>18422</th>\n","      <td>2020</td>\n","      <td>7</td>\n","      <td>PRESTIGE BEVERAGE GROUP OF MD LLC</td>\n","      <td>ROBERTSON CHARD - 750ML</td>\n","      <td>WINE</td>\n","      <td>0.16</td>\n","      <td>0.00</td>\n","      <td>1.00</td>\n","      <td>1.16</td>\n","    </tr>\n","    <tr>\n","      <th>268958</th>\n","      <td>2019</td>\n","      <td>9</td>\n","      <td>E &amp; J GALLO WINERY</td>\n","      <td>BAREFOOT CEL CHARD - BIB -3L</td>\n","      <td>WINE</td>\n","      <td>13.83</td>\n","      <td>11.00</td>\n","      <td>16.00</td>\n","      <td>29.83</td>\n","    </tr>\n","    <tr>\n","      <th>7237</th>\n","      <td>2020</td>\n","      <td>1</td>\n","      <td>MCNEILL INDEPENDENT SPIRIT CREATORS LLC</td>\n","      <td>GREGARIOUS GIN - 750ML</td>\n","      <td>LIQUOR</td>\n","      <td>3.91</td>\n","      <td>3.00</td>\n","      <td>0.00</td>\n","      <td>3.91</td>\n","    </tr>\n","    <tr>\n","      <th>76698</th>\n","      <td>2017</td>\n","      <td>9</td>\n","      <td>COASTAL BREWING COMPANY LLC</td>\n","      <td>FORDHAM SPICED HARVEST ALE 4/6 NR - 12OZ</td>\n","      <td>BEER</td>\n","      <td>6.00</td>\n","      <td>9.00</td>\n","      <td>35.00</td>\n","      <td>41.00</td>\n","    </tr>\n","    <tr>\n","      <th>266550</th>\n","      <td>2019</td>\n","      <td>9</td>\n","      <td>BUCK DISTRIBUTING COMPANY INC</td>\n","      <td>REGIA 12/32OZ NR - 32OZ</td>\n","      <td>BEER</td>\n","      <td>0.00</td>\n","      <td>0.00</td>\n","      <td>197.00</td>\n","      <td>197.00</td>\n","    </tr>\n","    <tr>\n","      <th>197602</th>\n","      <td>2019</td>\n","      <td>4</td>\n","      <td>BUCK DISTRIBUTING COMPANY INC</td>\n","      <td>STIEGL GRAPEFRUIT RADLER 16.9OZ 4 PK CAN</td>\n","      <td>BEER</td>\n","      <td>2.70</td>\n","      <td>3.00</td>\n","      <td>19.00</td>\n","      <td>21.70</td>\n","    </tr>\n","    <tr>\n","      <th>11849</th>\n","      <td>2020</td>\n","      <td>1</td>\n","      <td>MILLER BREWING COMPANY</td>\n","      <td>MOLSON ICE 2/12 LNNR - 12OZ</td>\n","      <td>BEER</td>\n","      <td>0.00</td>\n","      <td>0.00</td>\n","      <td>41.00</td>\n","      <td>41.00</td>\n","    </tr>\n","    <tr>\n","      <th>279759</th>\n","      <td>2019</td>\n","      <td>10</td>\n","      <td>LUNEAU USA INC</td>\n","      <td>NICOLAS MER - 750ML</td>\n","      <td>WINE</td>\n","      <td>7.80</td>\n","      <td>7.00</td>\n","      <td>2.00</td>\n","      <td>9.80</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4cd8624e-5407-4e17-8819-1b1b7fbeeba8')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-4cd8624e-5407-4e17-8819-1b1b7fbeeba8 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-4cd8624e-5407-4e17-8819-1b1b7fbeeba8');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-02edef41-5f05-4828-ab83-96c479014dce\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-02edef41-5f05-4828-ab83-96c479014dce')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-02edef41-5f05-4828-ab83-96c479014dce button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","summary":"{\n  \"name\": \"data\",\n  \"rows\": 10,\n  \"fields\": [\n    {\n      \"column\": \"YEAR\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1,\n        \"min\": 2017,\n        \"max\": 2020,\n        \"num_unique_values\": 3,\n        \"samples\": [\n          2017,\n          2020,\n          2019\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"MONTH\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3,\n        \"min\": 1,\n        \"max\": 10,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          9,\n          10,\n          1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"SUPPLIER\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 9,\n        \"samples\": [\n          \"MILLER BREWING COMPANY\",\n          \"A VINTNERS SELECTIONS\",\n          \"COASTAL BREWING COMPANY LLC\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ITEM_DESCRIPTION\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 10,\n        \"samples\": [\n          \"MOLSON ICE 2/12 LNNR - 12OZ\",\n          \"DR LOOSEN GRAY SLATE RIES - 750ML\",\n          \"FORDHAM SPICED HARVEST ALE 4/6 NR - 12OZ\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ITEM_TYPE\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"BEER\",\n          \"WINE\",\n          \"LIQUOR\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"RETAIL_SALES\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 6.635165994741788,\n        \"min\": 0.0,\n        \"max\": 19.35,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          0.0,\n          6.0,\n          19.35\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"RETAIL_TRANSFERS\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 6.818276093624318,\n        \"min\": 0.0,\n        \"max\": 21.0,\n        \"num_unique_values\": 6,\n        \"samples\": [\n          21.0,\n          0.0,\n          7.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"WAREHOUSE_SALES\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 59.02955945023552,\n        \"min\": 0.0,\n        \"max\": 197.0,\n        \"num_unique_values\": 9,\n        \"samples\": [\n          19.0,\n          4.0,\n          35.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"TOTAL_SALES\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 58.2265774081447,\n        \"min\": 1.16,\n        \"max\": 197.0,\n        \"num_unique_values\": 9,\n        \"samples\": [\n          21.7,\n          4.0,\n          41.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":14}],"source":["data.sample(10)"]},{"cell_type":"markdown","metadata":{"id":"zHz4R0FdoNZY"},"source":[]},{"cell_type":"markdown","metadata":{"id":"bhnv7RGkofum"},"source":["**utility functions**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6B2yy9j2oJK0"},"outputs":[],"source":["def plot_dist(df,variable,target):\n","\n","    # histogram\n","    plt.figure(figsize=(20,4))\n","    plt.subplot(1,5,1)\n","    sns.histplot(x = variable,bins=30,data=data)\n","    plt.title('histogram')\n","    plt.yticks(rotation=90)\n","    #scatter plot\n","    plt.subplot(1,5,2)\n","    sns.scatterplot(x= variable,y= target,data=data)\n","    plt.title('scatter')\n","    #boxplot\n","    plt.subplot(1,5,3)\n","    sns.boxplot(y= variable, data=data)\n","    plt.title('boxplot')\n","    plt.xlabel(variable)\n","    #barplot\n","    plt.subplot(1,5,4)\n","    sns.barplot(y= variable,x=target,data=data)\n","    plt.title('barplot')\n","    #regplot\n","    plt.subplot(1,5,5)\n","    sns.regplot(y= target,x=variable,data=data)\n","    plt.title('regplot')"]},{"cell_type":"markdown","metadata":{"id":"BjGBLMwkoD2-"},"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"S1vKAdkvevP8"},"outputs":[],"source":["\n","Features = numeric_cols.columns[numeric_cols.columns != 'TOTAL_SALES']\n","for feature in Features:\n","    plot_dist(numeric_cols, feature, \"TOTAL_SALES\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"otOVzk3zKh30"},"outputs":[],"source":["def plot_category(df, feature, target):\n","    plt.figure(figsize=(20,4))\n","    plt.subplot(1,3,1)\n","    #boxplot\n","    sns.boxplot(data=df, x=feature, y=target)\n","    plt.title('boxplot of ' + feature)\n","    plt.xticks(rotation=90)\n","    plt.subplot(1,3,2)\n","    #countplot\n","    sns.countplot(data = df, x = feature)\n","    plt.xticks(rotation=90)\n","    plt.title('countplot of ' + feature)\n","    plt.subplot(1,3,3)\n","    plt.xticks(rotation=90)\n","    #stripplot\n","    sns.stripplot(data=df, x=feature, y=target)\n","    plt.title('Strip plot of ' + 'price' + ' by ' + feature)\n","    plt.show()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KozKqjGhORDK"},"outputs":[],"source":["for var in non_numeric_cols.columns:\n","    plot_category(non_numeric_cols,var,data[\"TOTAL_SALES\"])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_sJV53X-oiSd"},"outputs":[],"source":["\n","plt.figure(figsize=(12,6))\n","sns.heatmap(numeric_cols.corr(),annot=True, cmap='Blues')\n","plt.show()"]},{"cell_type":"markdown","metadata":{"id":"_WmPOakEBx-X"},"source":[]},{"cell_type":"markdown","metadata":{"id":"awlVz-VNBnp9"},"source":["# Data Preprocessing"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ripy31XvCoer"},"outputs":[],"source":["ss = StandardScaler()\n","ohe = OneHotEncoder()\n","LR = LinearRegression()\n","Ridge = Ridge()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1F1qtEolBzsQ"},"outputs":[],"source":["numeric_preprocess = Pipeline(steps = [\n","(\"scale\",ss),\n","(\"impute\",SimpleImputer())\n","])\n","numeric_preprocess"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vR_VRkN_FUmR"},"outputs":[],"source":["categorical_preprocess = Pipeline(steps = [\n","(\"encoder\",ohe),\n","(\"impute\",SimpleImputer(strategy = \"most_frequent\"))\n","\n","])\n","categorical_preprocess"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Nrl_ZiFQHI4I"},"outputs":[],"source":["preprocessor = ColumnTransformer(transformers = [\n","(\"numerical\",numeric_preprocess, numeric_cols),\n","(\"categorical\",categorical_preprocess,non_numeric_cols)\n","])\n","preprocessor"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JR-ZzQgpI1uN"},"outputs":[],"source":["pipeline = Pipeline(steps = [\n","(\"preprocessor\", preprocessor),\n","(\"model\",LR),\n","(\"model2\",Ridge)\n","])\n","pipeline"]},{"cell_type":"markdown","metadata":{"id":"3vNqwjwkKlGE"},"source":["#Model Building"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qpoPxSAPKpPy"},"outputs":[],"source":["housing = data.copy()\n","sns.pairplot(housing)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oEV-oeLPKCij"},"outputs":[],"source":["X_train,X_test,y_train,y_test = train_test_split(X,y,random_state = 443)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PTz3u-EvKpSX"},"outputs":[],"source":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1zOPxlzug1V7NA-elHX4SWMRbS7myfFax","timestamp":1721752664873},{"file_id":"13ob5lZ6-WsM9cyL1jSHtbSdkLmh0pFu3","timestamp":1721633309301}],"authorship_tag":"ABX9TyPJPrrB050054GZxmBNgv2e"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}